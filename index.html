<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TRACER 2025</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
            overflow-x: hidden;
        }

        .container {
            max-width: 375px;
            margin: 0 auto;
            min-height: 100vh;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            position: relative;
        }

        .page {
            display: none;
            padding: 20px;
            min-height: 100vh;
            animation: slideIn 0.3s ease-out;
        }

        .page.active {
            display: block;
        }

        @keyframes slideIn {
            from { opacity: 0; transform: translateX(30px); }
            to { opacity: 1; transform: translateX(0); }
        }

        .header {
            text-align: center;
            margin-bottom: 40px;
            padding-top: 60px;
        }

        .logo {
            font-size: 2.5em;
            font-weight: bold;
            background: linear-gradient(45deg, #ff6b6b, #4ecdc4, #45b7d1);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 10px;
        }

        .subtitle {
            color: #666;
            font-size: 1.1em;
            margin-bottom: 30px;
        }

        .option-group {
            margin-bottom: 30px;
        }

        .option {
            background: rgba(255, 255, 255, 0.8);
            border: none;
            border-radius: 15px;
            padding: 18px 20px;
            margin: 10px 0;
            width: 100%;
            text-align: center;
            font-size: 1.1em;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
            position: relative;
            overflow: hidden;
        }

        .option:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
        }

        .option.selected {
            background: linear-gradient(45deg, #ff6b6b, #ffa726);
            color: white;
            transform: scale(1.02);
        }

        .flag {
            font-size: 1.5em;
            margin-right: 10px;
        }

        .hebrew { background: linear-gradient(45deg, #4fc3f7, #29b6f6); }
        .english { background: linear-gradient(45deg, #66bb6a, #43a047); }
        .russian { background: linear-gradient(45deg, #ef5350, #e53935); }
        .arabic { background: linear-gradient(45deg, #ab47bc, #8e24aa); }

        .position-doctor { background: linear-gradient(45deg, #ff7043, #ff5722); }
        .position-nurse { background: linear-gradient(45deg, #26c6da, #00acc1); }
        .position-support { background: linear-gradient(45deg, #66bb6a, #4caf50); }

        .btn {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
            border: none;
            border-radius: 25px;
            padding: 15px 30px;
            font-size: 1.1em;
            cursor: pointer;
            transition: all 0.3s ease;
            margin: 10px 5px;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.6);
        }

        .btn-secondary {
            background: linear-gradient(45deg, #ffa726, #ff9800);
            box-shadow: 0 4px 15px rgba(255, 167, 38, 0.4);
        }

        .btn-danger {
            background: linear-gradient(45deg, #ef5350, #f44336);
            box-shadow: 0 4px 15px rgba(239, 83, 80, 0.4);
        }

        .question-card {
            background: rgba(255, 255, 255, 0.9);
            border-radius: 20px;
            padding: 25px;
            margin: 20px 0;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            border-left: 5px solid #667eea;
        }

        .question {
            font-size: 1.2em;
            margin-bottom: 20px;
            line-height: 1.5;
            color: #2c3e50;
        }

        .answer {
            background: linear-gradient(45deg, #e8f5e8, #f0f8f0);
            padding: 15px;
            border-radius: 10px;
            margin-top: 15px;
            border-left: 4px solid #4caf50;
            color: #2e7d32;
            font-size: 1.1em;
            line-height: 1.4;
        }

        .controls {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            gap: 10px;
            z-index: 1000;
        }

        .theme-toggle {
            position: absolute;
            top: 20px;
            right: 20px;
            background: rgba(255, 255, 255, 0.8);
            border: none;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            font-size: 1.5em;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .dark-theme {
            background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);
            color: #ecf0f1;
        }

        .dark-theme .container {
            background: rgba(44, 62, 80, 0.95);
        }

        .dark-theme .option {
            background: rgba(52, 73, 94, 0.8);
            color: #ecf0f1;
        }

        .dark-theme .question-card {
            background: rgba(52, 73, 94, 0.9);
            color: #ffffff;
        }

        .dark-theme .answer {
            background: linear-gradient(45deg, #2c5530, #345838);
            color: #a5d6a7;
        }

        .warning {
            background: linear-gradient(45deg, #ff7043, #ff5722);
            color: white;
            padding: 20px;
            border-radius: 15px;
            text-align: center;
            margin: 20px 0;
            font-size: 1.1em;
            animation: shake 0.5s ease-in-out;
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            75% { transform: translateX(5px); }
        }

        .emoji {
            font-size: 2em;
            margin: 10px;
        }

        .upload-area {
            border: 2px dashed #667eea;
            border-radius: 15px;
            padding: 30px;
            text-align: center;
            margin: 20px 0;
            background: rgba(102, 126, 234, 0.1);
            transition: all 0.3s ease;
        }

        .upload-area:hover {
            background: rgba(102, 126, 234, 0.2);
            transform: scale(1.02);
        }

        .file-input {
            display: none;
        }

        .progress {
            width: 100%;
            height: 8px;
            background: rgba(255, 255, 255, 0.3);
            border-radius: 4px;
            overflow: hidden;
            margin: 20px 0;
        }

        .progress-bar {
            height: 100%;
            background: linear-gradient(45deg, #4caf50, #8bc34a);
            width: 0%;
            transition: width 0.3s ease;
        }
    </style>
</head>
<body>
    <div class="container">
        <button class="theme-toggle" onclick="toggleTheme()">üåô</button>

        <!-- –°—Ç—Ä–∞–Ω–∏—Ü–∞ 1: –í—ã–±–æ—Ä —è–∑—ã–∫–∞ -->
        <div class="page active" id="page1">
            <div class="header">
                <div class="logo">TRACER 2025</div>
                <div class="subtitle">üè• Healthcare accreditation</div>
                <div class="emoji">ü©∫üíäüß¨</div>
            </div>
            
            <div class="option-group">
                <button class="option hebrew" onclick="selectLanguage('he')">
                    <span class="flag">üáÆüá±</span> ◊¢◊ë◊®◊ô◊™
                </button>
                <button class="option english" onclick="selectLanguage('en')">
                    <span class="flag">üá∫üá∏</span> English
                </button>
                <button class="option russian" onclick="selectLanguage('ru')">
                    <span class="flag">üá∑üá∫</span> –†—É—Å—Å–∫–∏–π
                </button>
                <button class="option arabic" onclick="selectLanguage('ar')">
                    <span class="flag">üá∏üá¶</span> ÿπÿ±ÿ®Ÿä
                </button>
            </div>
        </div>

        <!-- –°—Ç—Ä–∞–Ω–∏—Ü–∞ 2: –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö -->
        <div class="page" id="page2">
            <div class="header">
                <div class="logo">üìö Loading data</div>
                <div class="subtitle" id="loadingStatus">Connecting to the source of questions...</div>
            </div>
            
            <div class="progress" id="uploadProgress">
                <div class="progress-bar" id="progressBar"></div>
            </div>

            <div style="text-align: center; margin-top: 30px;">
                <div class="emoji">üîÑ</div>
                <div id="loadingText">Loading up-to-date data...</div>
                <div style="font-size: 0.9em; color: #666; margin-top: 15px;">
                    ‚úÖ Doctors: <span id="doctorStatus">‚è≥ loading...</span><br>
                    ‚úÖ Nurses: <span id="nurseStatus">‚è≥ loading...</span><br>
                    ‚úÖ Junior medical staff: <span id="supportStatus">‚è≥ loading...</span>
                </div>
            </div>

            <div style="text-align: center; margin-top: 40px; display: none;" id="errorSection">
                <div class="warning">
                    <div class="emoji">‚ö†Ô∏è</div>
                    <div>Error loading data</div>
                </div>
                <button class="btn" onclick="retryLoadData()">Retry loading questions</button>
                <button class="btn btn-secondary" onclick="continueWithoutData()">–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø—Ä–∏–º–µ—Ä–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ</button>
            </div>

            <div style="text-align: center; margin-top: 30px; display: none;" id="successSection">
                <div class="emoji">üéâ</div>
                <div style="color: #4caf50; font-weight: bold;">Data loaded successfully!</div>
                <button class="btn" onclick="goToPage(3)" style="margin-top: 20px;">Continue</button>
            </div>
        </div>

        <!-- –°—Ç—Ä–∞–Ω–∏—Ü–∞ 3: –í—ã–±–æ—Ä –¥–æ–ª–∂–Ω–æ—Å—Ç–∏ -->
        <div class="page" id="page3">
            <div class="header">
                <div class="logo" id="selectPositionTitle">–í—ã–±–µ—Ä–∏—Ç–µ –¥–æ–ª–∂–Ω–æ—Å—Ç—å</div>
                <div class="emoji">üë•</div>
            </div>
            
            <div class="option-group">
                <button class="option position-doctor" onclick="selectPosition('doctor')">
                    <span class="emoji">üë®‚Äç‚öïÔ∏è</span>
                    <span id="doctorText">–í—Ä–∞—á</span>
                </button>
                <button class="option position-nurse" onclick="selectPosition('nurse')">
                    <span class="emoji">üë©‚Äç‚öïÔ∏è</span>
                    <span id="nurseText">–ú–µ–¥—Å–µ—Å—Ç—Ä–∞</span>
                </button>
                <button class="option position-support" onclick="selectPosition('support')">
                    <span class="emoji">üßë‚Äçüî¨</span>
                    <span id="supportText">–ú–ª–∞–¥—à–∏–π –º–µ–¥–ø–µ—Ä—Å–æ–Ω–∞–ª</span>
                </button>
            </div>
        </div>

        <!-- –°—Ç—Ä–∞–Ω–∏—Ü–∞ 4: –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–¥–æ–≤–æ–π —Ñ—Ä–∞–∑—ã -->
        <div class="page" id="page4">
            <div class="header">
                <div class="logo" id="codeCheckTitle">–ü—Ä–æ–≤–µ—Ä–∫–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏</div>
                <div class="emoji">üîê</div>
                <div class="subtitle" id="codeCheckSubtitle">–í—ã–±–µ—Ä–∏—Ç–µ –≤–µ—Ä–Ω—É—é –∫–æ–¥–æ–≤—É—é —Ñ—Ä–∞–∑—É:</div>
            </div>
            
            <div class="option-group">
                <button class="option" onclick="checkCode(false)">
                    <span id="code1">üçµ –í–æ–ª—å—Ñ—Å–æ–Ω —ç—Ç–æ –±—Ä–∞–∑–∏–ª—å—Å–∫–∏–π —á–∞–π</span>
                </button>
                <button class="option" onclick="checkCode(false)">
                    <span id="code2">üé¨ –í–æ–ª—å—Ñ—Å–æ–Ω —ç—Ç–æ –Ω–µ–º–µ—Ü–∫–∏–π –∞–∫—Ç–µ—Ä —Ñ–∏–ª—å–º–æ–≤ –¥–ª—è –≤–∑—Ä–æ—Å–ª—ã—Ö</span>
                </button>
                <button class="option" onclick="checkCode(false)">
                    <span id="code3">üöá –í–æ–ª—å—Ñ—Å–æ–Ω —ç—Ç–æ –Ω–∞–∑–≤–∞–Ω–∏–µ —Å—Ç–∞–Ω—Ü–∏–∏ –º–µ—Ç—Ä–æ –≤ –ú–æ—Å–∫–≤–µ</span>
                </button>
                <button class="option" onclick="checkCode(true)">
                    <span id="code4">üè† –í–æ–ª—å—Ñ—Å–æ–Ω —ç—Ç–æ –¥–æ–º</span>
                </button>
            </div>
            
            <div id="warningMessage" style="display: none;">
                <div class="warning">
                    <div class="emoji">üö®</div>
                    <div id="spyWarning">–ü–æ–¥–æ–∑—Ä–µ–Ω–∏–µ –Ω–∞ –ø—Ä–æ–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏–µ —à–ø–∏–æ–Ω–∞ –∏–∑ –±–æ–ª—å–Ω–∏—Ü—ã –ò—Ö–∏–ª–æ–≤!</div>
                    <div class="emoji">üïµÔ∏è‚Äç‚ôÇÔ∏è</div>
                </div>
            </div>
        </div>

        <!-- –°—Ç—Ä–∞–Ω–∏—Ü–∞ 5: –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Ä–µ–∂–∏–º–∞ -->
        <div class="page" id="page5">
            <div class="header">
                <div class="logo" id="settingsTitle">–ù–∞—Å—Ç—Ä–æ–π–∫–∏</div>
                <div class="emoji">‚öôÔ∏è</div>
            </div>
            
            <div class="option-group">
                <button class="option" onclick="selectMode('sequential')">
                    <span class="emoji">üìã</span>
                    <span id="sequentialText">–í—Å–µ –≤–æ–ø—Ä–æ—Å—ã –ø–æ–¥—Ä—è–¥</span>
                </button>
                <button class="option" onclick="selectMode('random')">
                    <span class="emoji">üé≤</span>
                    <span id="randomText">–°–ª—É—á–∞–π–Ω—ã–π –ø–æ—Ä—è–¥–æ–∫ –≤–æ–ø—Ä–æ—Å–æ–≤</span>
                </button>
                <button class="option" onclick="selectMode('quiz')">
                    <span class="emoji">üß†</span>
                    <span id="quizText">–ö–≤–∏–∑ (–æ—Ç–≤–µ—Ç –≤–∏–¥–µ–Ω –Ω–µ —Å—Ä–∞–∑—É)</span>
                </button>
            </div>
        </div>

        <!-- –°—Ç—Ä–∞–Ω–∏—Ü–∞ 6: –í–æ–ø—Ä–æ—Å—ã -->
        <div class="page" id="page6">
            <div class="header">
                <div class="logo" id="questionHeader">–í–æ–ø—Ä–æ—Å</div>
                <div id="questionCounter">1 / 100</div>
            </div>
            
            <div class="question-card">
                <div class="question" id="currentQuestion">–ó–∞–≥—Ä—É–∑–∫–∞ –≤–æ–ø—Ä–æ—Å–∞...</div>
                <div class="answer" id="currentAnswer" style="display: none;">–ó–∞–≥—Ä—É–∑–∫–∞ –æ—Ç–≤–µ—Ç–∞...</div>
                <button class="btn" id="showAnswerBtn" style="display: none;" onclick="showAnswer()">Show Answer</button>
            </div>

            <div class="controls">
                <button class="btn btn-secondary" onclick="goToPage(5)">
                    <span id="menuText">–ú–µ–Ω—é</span>
                </button>
                <button class="btn" onclick="nextQuestion()">
                    <span id="nextText">–î–∞–ª–µ–µ</span>
                </button>
                <button class="btn btn-danger" onclick="exitApp()">
                    <span id="exitText">–í—ã–π—Ç–∏</span>
                </button>
            </div>
        </div>
    </div>

    <script>
        // –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
        let currentLanguage = 'ru';
        let selectedPosition = '';
        let selectedMode = '';
        let isDarkTheme = false;
        let currentQuestionIndex = 0;
        let questionsData = {};
        let currentQuestions = [];

        // URL-–∞–¥—Ä–µ—Å–∞ Google Sheets
        const GOOGLE_SHEETS_URLS = {
            doctor: 'https://docs.google.com/spreadsheets/d/e/2PACX-1vSOYOQNAKfJydIub2AQ8usyHphnmgM_WYGy7nhduU_ZkLGKATe-75WQaF0FhpYy4-pkYsHNazHElg5p/pub?gid=366303685&single=true&output=csv',
            nurse: 'https://docs.google.com/spreadsheets/d/e/2PACX-1vSOYOQNAKfJydIub2AQ8usyHphnmgM_WYGy7nhduU_ZkLGKATe-75WQaF0FhpYy4-pkYsHNazHElg5p/pub?gid=1863455630&single=true&output=csv',
            support: 'https://docs.google.com/spreadsheets/d/e/2PACX-1vSOYOQNAKfJydIub2AQ8usyHphnmgM_WYGy7nhduU_ZkLGKATe-75WQaF0FhpYy4-pkYsHNazHElg5p/pub?gid=1339073068&single=true&output=csv'
        };

        // –ü–µ—Ä–µ–≤–æ–¥—ã
        const translations = {
            ru: {
                selectPositionTitle: '–í—ã–±–µ—Ä–∏—Ç–µ –¥–æ–ª–∂–Ω–æ—Å—Ç—å',
                doctorText: '–í—Ä–∞—á',
                nurseText: '–ú–µ–¥—Å–µ—Å—Ç—Ä–∞',
                supportText: '–ú–ª–∞–¥—à–∏–π –º–µ–¥–ø–µ—Ä—Å–æ–Ω–∞–ª',
                codeCheckTitle: '–ü—Ä–æ–≤–µ—Ä–∫–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏',
                codeCheckSubtitle: '–í—ã–±–µ—Ä–∏—Ç–µ –≤–µ—Ä–Ω—É—é –∫–æ–¥–æ–≤—É—é —Ñ—Ä–∞–∑—É:',
                code1: 'üçµ –í–æ–ª—å—Ñ—Å–æ–Ω —ç—Ç–æ –±—Ä–∞–∑–∏–ª—å—Å–∫–∏–π —á–∞–π',
                code2: 'üé¨ –í–æ–ª—å—Ñ—Å–æ–Ω —ç—Ç–æ –Ω–µ–º–µ—Ü–∫–∏–π –∞–∫—Ç–µ—Ä —Ñ–∏–ª—å–º–æ–≤ –¥–ª—è –≤–∑—Ä–æ—Å–ª—ã—Ö',
                code3: 'üöá –í–æ–ª—å—Ñ—Å–æ–Ω —ç—Ç–æ –Ω–∞–∑–≤–∞–Ω–∏–µ —Å—Ç–∞–Ω—Ü–∏–∏ –º–µ—Ç—Ä–æ –≤ –ú–æ—Å–∫–≤–µ',
                code4: 'üè† –í–æ–ª—å—Ñ—Å–æ–Ω —ç—Ç–æ –¥–æ–º',
                spyWarning: '–ü–æ–¥–æ–∑—Ä–µ–Ω–∏–µ –Ω–∞ –ø—Ä–æ–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏–µ —à–ø–∏–æ–Ω–∞ –∏–∑ –±–æ–ª—å–Ω–∏—Ü—ã –ò—Ö–∏–ª–æ–≤!',
                settingsTitle: '–ù–∞—Å—Ç—Ä–æ–π–∫–∏',
                sequentialText: '–í—Å–µ –≤–æ–ø—Ä–æ—Å—ã –ø–æ–¥—Ä—è–¥',
                randomText: '–°–ª—É—á–∞–π–Ω—ã–π –ø–æ—Ä—è–¥–æ–∫ –≤–æ–ø—Ä–æ—Å–æ–≤',
                quizText: '–ö–≤–∏–∑ (–æ—Ç–≤–µ—Ç –≤–∏–¥–µ–Ω –Ω–µ —Å—Ä–∞–∑—É)',
                questionHeader: '–í–æ–ø—Ä–æ—Å',
                menuText: '–ú–µ–Ω—é',
                nextText: '–î–∞–ª–µ–µ',
                exitText: '–í—ã–π—Ç–∏'
            },
            en: {
                selectPositionTitle: 'Select Position',
                doctorText: 'Doctor',
                nurseText: 'Nurse',
                supportText: 'Support Staff',
                codeCheckTitle: 'Security Check',
                codeCheckSubtitle: 'Choose the correct code phrase:',
                code1: 'üçµ Wolfson is Brazilian tea',
                code2: 'üé¨ Wolfson is German adult film actor',
                code3: 'üöá Wolfson is Moscow metro station',
                code4: 'üè† Wolfson is home',
                spyWarning: 'Suspected spy infiltration from Ichilov Hospital!',
                settingsTitle: 'Settings',
                sequentialText: 'All questions in order',
                randomText: 'Random order questions',
                quizText: 'Quiz (answer not visible immediately)',
                questionHeader: 'Question',
                menuText: 'Menu',
                nextText: 'Next',
                exitText: 'Exit'
            },
            he: {
                selectPositionTitle: '◊ë◊ó◊® ◊™◊§◊ß◊ô◊ì',
                doctorText: '◊®◊ï◊§◊ê',
                nurseText: '◊ê◊ó◊ï◊™',
                supportText: '◊¶◊ï◊ï◊™ ◊û◊ß◊¶◊ï◊¢◊ô',
                codeCheckTitle: '◊ë◊ì◊ô◊ß◊™ ◊ê◊ë◊ò◊ó◊î',
                codeCheckSubtitle: '◊ë◊ó◊® ◊ê◊™ ◊î◊ë◊ô◊ò◊ï◊ô ◊î◊†◊õ◊ï◊ü:',
                code1: 'üçµ ◊ï◊ï◊ú◊§◊°◊ï◊ü ◊ñ◊î ◊™◊î ◊ë◊®◊ñ◊ô◊ú◊ê◊ô',
                code2: 'üé¨ ◊ï◊ï◊ú◊§◊°◊ï◊ü ◊ñ◊î ◊©◊ó◊ß◊ü ◊í◊®◊û◊†◊ô ◊ë◊°◊®◊ò◊ô ◊û◊ë◊ï◊í◊®◊ô◊ù',
                code3: 'üöá ◊ï◊ï◊ú◊§◊°◊ï◊ü ◊ñ◊î ◊©◊ù ◊©◊ú ◊™◊ó◊†◊™ ◊®◊õ◊ë◊™ ◊™◊ó◊™◊ô◊™ ◊ë◊û◊ï◊°◊ß◊ë◊î',
                code4: 'üè† ◊ï◊ï◊ú◊§◊°◊ï◊ü ◊ñ◊î ◊ë◊ô◊™',
                spyWarning: '◊ó◊©◊ì ◊ú◊ó◊ì◊ô◊®◊™ ◊û◊®◊í◊ú ◊û◊ë◊ô◊™ ◊î◊ó◊ï◊ú◊ô◊ù ◊ê◊ô◊õ◊ô◊ú◊ï◊ë!',
                settingsTitle: '◊î◊í◊ì◊®◊ï◊™',
                sequentialText: '◊õ◊ú ◊î◊©◊ê◊ú◊ï◊™ ◊ë◊®◊¶◊£',
                randomText: '◊°◊ì◊® ◊ê◊ß◊®◊ê◊ô ◊©◊ú ◊©◊ê◊ú◊ï◊™',
                quizText: '◊ó◊ô◊ì◊ï◊ü (◊î◊™◊©◊ï◊ë◊î ◊ú◊ê ◊†◊®◊ê◊ô◊™ ◊û◊ô◊ì)',
                questionHeader: '◊©◊ê◊ú◊î',
                menuText: '◊™◊§◊®◊ô◊ò',
                nextText: '◊î◊ë◊ê',
                exitText: '◊ô◊¶◊ô◊ê◊î'
            },
            ar: {
                selectPositionTitle: 'ÿßÿÆÿ™ÿ± ÿßŸÑŸÖŸÜÿµÿ®',
                doctorText: 'ÿ∑ÿ®Ÿäÿ®',
                nurseText: 'ŸÖŸÖÿ±ÿ∂ÿ©',
                supportText: 'ÿ∑ÿßŸÇŸÖ ŸÖÿ≥ÿßÿπÿØ',
                codeCheckTitle: 'ŸÅÿ≠ÿµ ÿßŸÑÿ£ŸÖÿßŸÜ',
                codeCheckSubtitle: 'ÿßÿÆÿ™ÿ± ÿßŸÑÿπÿ®ÿßÿ±ÿ© ÿßŸÑÿµÿ≠Ÿäÿ≠ÿ©:',
                code1: 'üçµ ŸàŸàŸÑŸÅÿ≥ŸàŸÜ ŸáŸà ÿ¥ÿßŸä ÿ®ÿ±ÿßÿ≤ŸäŸÑŸä',
                code2: 'üé¨ ŸàŸàŸÑŸÅÿ≥ŸàŸÜ ŸÖŸÖÿ´ŸÑ ÿ£ŸÑŸÖÿßŸÜŸä ŸÅŸä ÿ£ŸÅŸÑÿßŸÖ ÿßŸÑÿ®ÿßŸÑÿ∫ŸäŸÜ',
                code3: 'üöá ŸàŸàŸÑŸÅÿ≥ŸàŸÜ ÿßÿ≥ŸÖ ŸÖÿ≠ÿ∑ÿ© ŸÖÿ™ÿ±Ÿà ŸÅŸä ŸÖŸàÿ≥ŸÉŸà',
                code4: 'üè† ŸàŸàŸÑŸÅÿ≥ŸàŸÜ ŸáŸà ÿßŸÑÿ®Ÿäÿ™',
                spyWarning: 'ÿßÿ¥ÿ™ÿ®ÿßŸá ŸÅŸä ÿ™ÿ≥ŸÑŸÑ ÿ¨ÿßÿ≥Ÿàÿ≥ ŸÖŸÜ ŸÖÿ≥ÿ™ÿ¥ŸÅŸâ ÿ•ŸäÿÆŸäŸÑŸàŸÅ!',
                settingsTitle: 'ÿßŸÑÿ•ÿπÿØÿßÿØÿßÿ™',
                sequentialText: 'ÿ¨ŸÖŸäÿπ ÿßŸÑÿ£ÿ≥ÿ¶ŸÑÿ© ÿ®ÿßŸÑÿ™ÿ±ÿ™Ÿäÿ®',
                randomText: 'ÿ™ÿ±ÿ™Ÿäÿ® ÿπÿ¥Ÿàÿßÿ¶Ÿä ŸÑŸÑÿ£ÿ≥ÿ¶ŸÑÿ©',
                quizText: 'ÿßÿÆÿ™ÿ®ÿßÿ± (ÿßŸÑÿ•ÿ¨ÿßÿ®ÿ© ÿ∫Ÿäÿ± ŸÖÿ±ÿ¶Ÿäÿ© ŸÅŸàÿ±ÿßŸã)',
                questionHeader: 'ÿ≥ÿ§ÿßŸÑ',
                menuText: 'ÿßŸÑŸÇÿßÿ¶ŸÖÿ©',
                nextText: 'ÿßŸÑÿ™ÿßŸÑŸä',
                exitText: 'ÿÆÿ±Ÿàÿ¨'
            }
        };

        // –ü—Ä–∏–º–µ—Ä–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏
        const sampleData = {
            doctor: [
                {
                    number: '1',
                    question_he: '◊û◊î ◊î◊ù ◊î◊°◊ô◊û◊§◊ò◊ï◊û◊ô◊ù ◊î◊®◊ê◊©◊ï◊†◊ô◊ô◊ù ◊©◊ú ◊î◊™◊ß◊£ ◊ú◊ë?',
                    answer_he: '◊õ◊ê◊ë ◊ë◊ó◊ñ◊î, ◊ß◊ï◊¶◊® ◊†◊©◊ô◊û◊î, ◊ë◊ó◊ô◊ú◊ï◊™',
                    question_ru: '–ö–∞–∫–æ–≤—ã –ø–µ—Ä–≤–∏—á–Ω—ã–µ —Å–∏–º–ø—Ç–æ–º—ã –∏–Ω—Ñ–∞—Ä–∫—Ç–∞ –º–∏–æ–∫–∞—Ä–¥–∞?',
                    answer_ru: '–ë–æ–ª—å –≤ –≥—Ä—É–¥–∏, –æ–¥—ã—à–∫–∞, —Ç–æ—à–Ω–æ—Ç–∞',
                    question_en: 'What are the primary symptoms of myocardial infarction?',
                    answer_en: 'Chest pain, shortness of breath, nausea',
                    question_ar: 'ŸÖÿß ŸáŸä ÿßŸÑÿ£ÿπÿ±ÿßÿ∂ ÿßŸÑÿ£ŸàŸÑŸäÿ© ŸÑÿßÿ≠ÿ™ÿ¥ÿßÿ° ÿπÿ∂ŸÑÿ© ÿßŸÑŸÇŸÑÿ®ÿü',
                    answer_ar: 'ÿ£ŸÑŸÖ ŸÅŸä ÿßŸÑÿµÿØÿ±ÿå ÿ∂ŸäŸÇ ŸÅŸä ÿßŸÑÿ™ŸÜŸÅÿ≥ÿå ÿ∫ÿ´ŸäÿßŸÜ'
                },
                {
                    number: '2',
                    question_he: '◊ê◊ô◊ö ◊û◊ò◊§◊ú◊ô◊ù ◊ë◊ñ◊ô◊î◊ï◊ù ◊ë◊ì◊®◊õ◊ô ◊î◊©◊™◊ü?',
                    answer_he: '◊ê◊†◊ò◊ô◊ë◊ô◊ï◊ò◊ô◊ß◊î, ◊î◊®◊ë◊î ◊†◊ï◊ñ◊ú◊ô◊ù, ◊û◊†◊ï◊ó◊î',
                    question_ru: '–ö–∞–∫ –ª–µ—á–∏—Ç—å –∏–Ω—Ñ–µ–∫—Ü–∏—é –º–æ—á–µ–≤—ã–≤–æ–¥—è—â–∏—Ö –ø—É—Ç–µ–π?',
                    answer_ru: '–ê–Ω—Ç–∏–±–∏–æ—Ç–∏–∫–∏, –º–Ω–æ–≥–æ –∂–∏–¥–∫–æ—Å—Ç–∏, –ø–æ–∫–æ–π',
                    question_en: 'How to treat urinary tract infection?',
                    answer_en: 'Antibiotics, plenty of fluids, rest',
                    question_ar: 'ŸÉŸäŸÅ ÿ™ÿπÿßŸÑÿ¨ ÿπÿØŸàŸâ ÿßŸÑŸÖÿ≥ÿßŸÑŸÉ ÿßŸÑÿ®ŸàŸÑŸäÿ©ÿü',
                    answer_ar: 'ÿßŸÑŸÖÿ∂ÿßÿØÿßÿ™ ÿßŸÑÿ≠ŸäŸàŸäÿ©ÿå ÿßŸÑŸÉÿ´Ÿäÿ± ŸÖŸÜ ÿßŸÑÿ≥Ÿàÿßÿ¶ŸÑÿå ÿßŸÑÿ±ÿßÿ≠ÿ©'
                }
            ],
            nurse: [
                {
                    number: '1',
                    question_he: '◊ê◊ô◊ö ◊û◊ï◊ì◊ì◊ô◊ù ◊ú◊ó◊• ◊ì◊ù ◊†◊õ◊ï◊ü?',
                    answer_he: '◊¢◊ù ◊û◊õ◊©◊ô◊® ◊ú◊ó◊• ◊ì◊ù ◊™◊ß◊ô◊ü, ◊ë◊ô◊©◊ô◊ë◊î, ◊ñ◊®◊ï◊¢ ◊ë◊í◊ï◊ë◊î ◊î◊ú◊ë',
                    question_ru: '–ö–∞–∫ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –∏–∑–º–µ—Ä–∏—Ç—å –∞—Ä—Ç–µ—Ä–∏–∞–ª—å–Ω–æ–µ –¥–∞–≤–ª–µ–Ω–∏–µ?',
                    answer_ru: '–ò—Å–ø—Ä–∞–≤–Ω—ã–º —Ç–æ–Ω–æ–º–µ—Ç—Ä–æ–º, –≤ –ø–æ–ª–æ–∂–µ–Ω–∏–∏ —Å–∏–¥—è, —Ä—É–∫–∞ –Ω–∞ —É—Ä–æ–≤–Ω–µ —Å–µ—Ä–¥—Ü–∞',
                    question_en: 'How to measure blood pressure correctly?',
                    answer_en: 'With a working tonometer, sitting position, arm at heart level',
                    question_ar: 'ŸÉŸäŸÅ ÿ™ŸÇŸäÿ≥ ÿ∂ÿ∫ÿ∑ ÿßŸÑÿØŸÖ ÿ®ÿ¥ŸÉŸÑ ÿµÿ≠Ÿäÿ≠ÿü',
                    answer_ar: 'ÿ®ÿ¨Ÿáÿßÿ≤ ŸÇŸäÿßÿ≥ ÿ∂ÿ∫ÿ∑ ÿ≥ŸÑŸäŸÖÿå ŸÅŸä Ÿàÿ∂ÿπŸäÿ© ÿßŸÑÿ¨ŸÑŸàÿ≥ÿå ÿßŸÑÿ∞ÿ±ÿßÿπ ÿπŸÑŸâ ŸÖÿ≥ÿ™ŸàŸâ ÿßŸÑŸÇŸÑÿ®'
                }
            ],
            support: [
                {
                    number: '1',
                    question_he: '◊ê◊ô◊ö ◊û◊ó◊ò◊ê◊ô◊ù ◊ô◊ì◊ô◊ô◊ù ◊†◊õ◊ï◊ü?',
                    answer_he: '◊°◊ë◊ï◊ü ◊ú◊û◊©◊ö 20 ◊©◊†◊ô◊ï◊™ ◊ê◊ï ◊ê◊ú◊õ◊ï◊î◊ï◊ú 70%',
                    question_ru: '–ö–∞–∫ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –¥–µ–∑–∏–Ω—Ñ–∏—Ü–∏—Ä–æ–≤–∞—Ç—å —Ä—É–∫–∏?',
                    answer_ru: '–ú—ã–ª–æ –≤ —Ç–µ—á–µ–Ω–∏–µ 20 —Å–µ–∫—É–Ω–¥ –∏–ª–∏ —Å–ø–∏—Ä—Ç 70%',
                    question_en: 'How to disinfect hands correctly?',
                    answer_en: 'Soap for 20 seconds or 70% alcohol',
                    question_ar: 'ŸÉŸäŸÅ ÿ™ÿ∑Ÿáÿ± ÿßŸÑŸäÿØŸäŸÜ ÿ®ÿ¥ŸÉŸÑ ÿµÿ≠Ÿäÿ≠ÿü',
                    answer_ar: 'ÿßŸÑÿµÿßÿ®ŸàŸÜ ŸÑŸÖÿØÿ© 20 ÿ´ÿßŸÜŸäÿ© ÿ£Ÿà ÿßŸÑŸÉÿ≠ŸàŸÑ 70%'
                }
            ]
        };

        // –§—É–Ω–∫—Ü–∏–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞–º–∏
        function goToPage(pageNumber) {
            document.querySelectorAll('.page').forEach(page => page.classList.remove('active'));
            document.getElementById(`page${pageNumber}`).classList.add('active');
        }

        function selectLanguage(lang) {
            currentLanguage = lang;
            updateTranslations();
            // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ –∏–∑ Google Sheets
            loadDataFromGoogleSheets();
            goToPage(2);
        }

        // –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∏–∑ Google Sheets
        async function loadDataFromGoogleSheets() {
            document.getElementById('uploadProgress').style.display = 'block';
            document.getElementById('errorSection').style.display = 'none';
            document.getElementById('successSection').style.display = 'none';
            
            let loadedCount = 0;
            let totalCount = 3;
            let hasErrors = false;

            // –ó–∞–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ –¥–ª—è –≤—Å–µ—Ö —Ç–∏–ø–æ–≤ –ø–µ—Ä—Å–æ–Ω–∞–ª–∞
            for (const [type, url] of Object.entries(GOOGLE_SHEETS_URLS)) {
                try {
                    const response = await fetch(url);
                    if (!response.ok) throw new Error(`HTTP ${response.status}`);
                    
                    const csvText = await response.text();
                    const data = parseCSV(csvText);
                    questionsData[type] = data;
                    
                    // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç—É—Å –∑–∞–≥—Ä—É–∑–∫–∏
                    updateLoadingStatus(type, 'success', data.length);
                    loadedCount++;
                    
                } catch (error) {
                    console.error(`–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ ${type}:`, error);
                    updateLoadingStatus(type, 'error');
                    hasErrors = true;
                }
                
                // –û–±–Ω–æ–≤–ª—è–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä
                const progress = (loadedCount / totalCount) * 100;
                document.getElementById('progressBar').style.width = progress + '%';
            }

            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç –∑–∞–≥—Ä—É–∑–∫–∏
            setTimeout(() => {
                if (hasErrors && loadedCount === 0) {
                    document.getElementById('errorSection').style.display = 'block';
                } else {
                    document.getElementById('successSection').style.display = 'block';
                    if (hasErrors) {
                        document.getElementById('loadingText').textContent = 
                            '–ß–∞—Å—Ç–∏—á–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞ (–Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –¥–∞–Ω–Ω—ã–µ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã)';
                    }
                }
            }, 500);
        }

        function updateLoadingStatus(type, status, count = 0) {
            const statusMap = {
                doctor: 'doctorStatus',
                nurse: 'nurseStatus', 
                support: 'supportStatus'
            };
            
            const element = document.getElementById(statusMap[type]);
            if (status === 'success') {
                element.textContent = `‚úÖ ${count} questions loaded`;
                element.style.color = '#4caf50';
            } else {
                element.textContent = '‚ùå Error loading data';
                element.style.color = '#f44336';
            }
        }

        function retryLoadData() {
            loadDataFromGoogleSheets();
        }

        function updateTranslations() {
            const trans = translations[currentLanguage];
            if (!trans) return;

            Object.keys(trans).forEach(key => {
                const element = document.getElementById(key);
                if (element) {
                    element.textContent = trans[key];
                }
            });
        }

        function selectPosition(position) {
            selectedPosition = position;
            document.querySelectorAll('.position-doctor, .position-nurse, .position-support').forEach(btn => {
                btn.classList.remove('selected');
            });
            event.target.closest('.option').classList.add('selected');
            setTimeout(() => goToPage(4), 500);
        }

        function checkCode(isCorrect) {
            if (isCorrect) {
                goToPage(5);
            } else {
                document.getElementById('warningMessage').style.display = 'block';
                setTimeout(() => {
                    document.getElementById('warningMessage').style.display = 'none';
                }, 3000);
            }
        }

        function selectMode(mode) {
            selectedMode = mode;
            document.querySelectorAll('#page5 .option').forEach(btn => {
                btn.classList.remove('selected');
            });
            event.target.closest('.option').classList.add('selected');
            setTimeout(() => {
                prepareQuestions();
                goToPage(6);
            }, 500);
        }

        function prepareQuestions() {
            const data = questionsData[selectedPosition] || sampleData[selectedPosition] || [];
            currentQuestions = [...data];
            
            if (selectedMode === 'random' || selectedMode === 'quiz') {
                // –ü–µ—Ä–µ–º–µ—à–∏–≤–∞–µ–º –≤–æ–ø—Ä–æ—Å—ã
                for (let i = currentQuestions.length - 1; i > 0; i--) {
                    const j = Math.floor(Math.random() * (i + 1));
                    [currentQuestions[i], currentQuestions[j]] = [currentQuestions[j], currentQuestions[i]];
                }
            }
            
            currentQuestionIndex = 0;
            showCurrentQuestion();
        }

        function showCurrentQuestion() {
            if (currentQuestionIndex >= currentQuestions.length) {
                alert('–í—Å–µ –≤–æ–ø—Ä–æ—Å—ã –ø—Ä–æ–π–¥–µ–Ω—ã! üéâ');
                goToPage(5);
                return;
            }

            const question = currentQuestions[currentQuestionIndex];
            const questionKey = `question_${currentLanguage}`;
            const answerKey = `answer_${currentLanguage}`;

            document.getElementById('currentQuestion').textContent = 
                question[questionKey] || question.question_ru || '–í–æ–ø—Ä–æ—Å –Ω–µ –Ω–∞–π–¥–µ–Ω';
            
            document.getElementById('currentAnswer').textContent = 
                question[answerKey] || question.answer_ru || '–û—Ç–≤–µ—Ç –Ω–µ –Ω–∞–π–¥–µ–Ω';

            document.getElementById('questionCounter').textContent = 
                `${currentQuestionIndex + 1} / ${currentQuestions.length}`;

            // –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –≤–∏–¥–∏–º–æ—Å—Ç–∏ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ä–µ–∂–∏–º–∞
            if (selectedMode === 'quiz') {
                document.getElementById('currentAnswer').style.display = 'none';
                document.getElementById('showAnswerBtn').style.display = 'block';
            } else {
                document.getElementById('currentAnswer').style.display = 'block';
                document.getElementById('showAnswerBtn').style.display = 'none';
            }
        }

        function showAnswer() {
            document.getElementById('currentAnswer').style.display = 'block';
            document.getElementById('showAnswerBtn').style.display = 'none';
        }

        function nextQuestion() {
            currentQuestionIndex++;
            showCurrentQuestion();
        }

        function exitApp() {
            if (confirm('Are you sure you want to exit?')) {
                goToPage(1);
                resetApp();
            }
        }

        function resetApp() {
            currentLanguage = 'ru';
            selectedPosition = '';
            selectedMode = '';
            currentQuestionIndex = 0;
            currentQuestions = [];
            document.querySelectorAll('.option').forEach(btn => {
                btn.classList.remove('selected');
            });
        }

        function toggleTheme() {
            isDarkTheme = !isDarkTheme;
            document.body.classList.toggle('dark-theme', isDarkTheme);
            document.querySelector('.theme-toggle').textContent = isDarkTheme ? '‚òÄÔ∏è' : 'üåô';
        }

        function parseCSV(csv) {
            const lines = csv.split('\n');
            const result = [];
            
            for (let i = 1; i < lines.length; i++) { // –ü—Ä–æ–ø—É—Å–∫–∞–µ–º –∑–∞–≥–æ–ª–æ–≤–æ–∫
                const line = lines[i].trim();
                if (!line) continue;
                
                const columns = parseCSVLine(line);
                if (columns.length >= 9) {
                    // –°—Ç—Ä—É–∫—Ç—É—Ä–∞: A=–Ω–æ–º–µ—Ä, B=–≤–æ–ø—Ä–æ—Å_–∏–≤—Ä–∏—Ç, C=–æ—Ç–≤–µ—Ç_–∏–≤—Ä–∏—Ç, D=–≤–æ–ø—Ä–æ—Å_—Ä—É—Å, E=–æ—Ç–≤–µ—Ç_—Ä—É—Å, F=–≤–æ–ø—Ä–æ—Å_–∞–Ω–≥–ª, G=–æ—Ç–≤–µ—Ç_–∞–Ω–≥–ª, H=–≤–æ–ø—Ä–æ—Å_–∞—Ä–∞–±, I=–æ—Ç–≤–µ—Ç_–∞—Ä–∞–±
                    result.push({
                        number: columns[0] || '',
                        question_he: columns[1] || '',
                        answer_he: columns[2] || '',
                        question_ru: columns[3] || '',
                        answer_ru: columns[4] || '',
                        question_en: columns[5] || '',
                        answer_en: columns[6] || '',
                        question_ar: columns[7] || '',
                        answer_ar: columns[8] || ''
                    });
                }
            }
            
            return result;
        }

        function parseCSVLine(line) {
            const result = [];
            let current = '';
            let inQuotes = false;
            
            for (let i = 0; i < line.length; i++) {
                const char = line[i];
                
                if (char === '"') {
                    if (inQuotes && line[i + 1] === '"') {
                        // –≠–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –∫–∞–≤—ã—á–∫–∞
                        current += '"';
                        i++; // –ü—Ä–æ–ø—É—Å–∫–∞–µ–º —Å–ª–µ–¥—É—é—â—É—é –∫–∞–≤—ã—á–∫—É
                    } else {
                        inQuotes = !inQuotes;
                    }
                } else if (char === ',' && !inQuotes) {
                    result.push(current);
                    current = '';
                } else {
                    current += char;
                }
            }
            
            result.push(current);
            return result.map(cell => cell.trim().replace(/^"|"$/g, ''));
        }

        function continueWithoutData() {
            questionsData = sampleData;
            goToPage(3);
        }

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
        document.addEventListener('DOMContentLoaded', function() {
            updateTranslations();
        });
    </script>
</body>
</html>
